<app-innercard titulo="Contrato" [estiloCard]="{'padding': '0em',}">
  @if (contrato()) {
  <div class="containerHeader">
    <div>
      <div class="details-container">
        <p><strong>Contrato:</strong> {{ contrato()?.numeroContrato }}</p>
        <p><strong>Cliente:</strong> {{ contrato()?.nomeCliente }}</p>
        <p><strong>Status:</strong> {{ contrato()?.statusContrato }}</p>
        <p><strong>Valor:</strong> {{ contrato()?.valorTotal | currency: 'BRL' }}</p>
      </div>
      <div class="details-container">
        <p><strong>Descrição:</strong> {{ contrato()?.descricao }}</p>
        <p><strong>Data de início:</strong> {{ contrato()?.dataInicio| date: 'dd/MM/yyyy' }}</p>
        <p><strong>Data de fim:</strong> {{ contrato()?.dataFim| date: 'dd/MM/yyyy' }}</p>
      </div>
    </div>
    <div>
      @if(contrato()?.statusContrato === statusContratoConcluido){
      <mat-icon class="color-heightline mat-icon-48" matTooltip="Contrato concluído">verified</mat-icon>
      }
    </div>
  </div>
  } @else {
  <p>Carregando detalhes da turma...</p>
  }


  <section class="section-actions">
    <button mat-raised-button color="secondary" routerLink="/conta/receber">Voltar</button>
    @if(contasReceber().length===0){
    <button mat-raised-button color="primary" (click)="criarContas()">Criar Contas</button>
    } @else if(podeCriarContas()){
    <button mat-raised-button color="primary" (click)="criarConta()">Criar Conta</button>
    }
  </section>

  <app-innercard titulo="Contas a Receber" [estiloCard]="{'padding': '0em','margin-top': '1em'}">
    @if(contasReceber().length>0){
    <section class="lista">
      <table mat-table [dataSource]="contasReceber()" matSort (matSortChange)="sortData($event)"
        class="mat-elevation-z8">

        <ng-container matColumnDef="dataVencimento">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="dataVencimento"> Data de Vencimento </th>
          <td mat-cell *matCellDef="let element"> {{element.dataVencimento | date: 'dd/MM/yyyy'}} </td>
          <td mat-footer-cell *matFooterCellDef> <strong>Totais:</strong> </td>
        </ng-container>

        <ng-container matColumnDef="valorTotal">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="valorTotal"> Valor </th>
          <td mat-cell *matCellDef="let element"> {{element.valorTotal | currency: 'BRL'}} </td>
          <td mat-footer-cell *matFooterCellDef> <strong>{{getTotalValorTotal() | currency: 'BRL'}} </strong></td>
        </ng-container>

        <ng-container matColumnDef="desconto">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="desconto"> Desconto </th>
          <td mat-cell *matCellDef="let element"> {{(element.valorTotal * element.desconto / 100) | currency: 'BRL'}}
            ({{element.desconto}}%) </td>
          <td mat-footer-cell *matFooterCellDef> <strong>{{getTotalDesconto() | currency: 'BRL'}} </strong></td>
        </ng-container>

        <ng-container matColumnDef="valorPago">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="valorPago"> Valor Pago </th>
          <td mat-cell *matCellDef="let element"> {{element.valorPago | currency: 'BRL'}} </td>
          <td mat-footer-cell *matFooterCellDef> <strong>{{getTotalValorPago() | currency: 'BRL'}} </strong></td>
        </ng-container>

        <ng-container matColumnDef="dataPagamento">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="dataPagamento"> Data do pagamento </th>
          <td mat-cell *matCellDef="let element"> {{element.dataPagamento | date: 'dd/MM/yyyy'}} </td>
          <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="status"> Status </th>
          <td mat-cell *matCellDef="let element"> {{getStatus(element.status)}} </td>
          <td mat-footer-cell *matFooterCellDef></td>
        </ng-container>

        <ng-container matColumnDef="acoes">
          <th mat-header-cell *matHeaderCellDef> </th>
          <td mat-cell *matCellDef="let element" class="cursorSelect">
            <a aria-hidden="false" (click)="visualizar(element)" matTooltip="Visualizar" class="cursorSelect">
              <mat-icon color="primary">topic</mat-icon>
            </a>
            <a matTooltip="Alterar" aria-hidden="false" (click)="alterar(element)" class="cursorSelect">
              <mat-icon color="primary">edit</mat-icon>
            </a>
            @if(element.status !== 'PAGA'){
            <a matTooltip="Pagar" aria-hidden="false" (click)="dialogPagamento(element)" class="cursorSelect">
              <mat-icon color="primary">wallet</mat-icon>
            </a>
            }@else {
            <a matTooltip="Conta paga" aria-hidden="false" class="cursorSelect">
              <mat-icon class="color-heightline">verified</mat-icon>
            </a>
            }
            <a matTooltip="Remover" aria-hidden="false" (click)="confirmarExclusao(element)" class="cursorSelect">
              <mat-icon color="primary">delete</mat-icon>
            </a>
          </td>
          <td mat-footer-cell *matFooterCellDef></td>

        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr mat-footer-row *matFooterRowDef="displayedColumns;" class="mat-row-footer"></tr>
        <!-- [ngClass]="getLineClass(row.statusCliente)" -->
      </table>
    </section>
    } @else {
    <span>Nenhum conta cadastrada</span>
    }
  </app-innercard>
</app-innercard>